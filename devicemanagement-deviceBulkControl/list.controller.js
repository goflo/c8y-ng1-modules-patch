"use strict";!function(){function t(n,i,t,e,o,r,s,a,l){var u={},c={withDeleted:!0},p={showGroupLink:!i.groupId,showProgressBar:!0,showEditable:!0,showDetails:!1},g={promise:null,toggle:function(){this.promise?this.stop():this.start()},start:function(){this.promise||(v(),this.promise=t(v,1e4))},stop:function(){this.promise&&(t.cancel(this.promise),this.promise=null)},icon:function(){return r.icon(!!this.promise)},color:function(){return this.promise?"realtime-on":"realtime-off"},state:function(){return!!this.promise}};function h(t){var e=function(t){var e=t||c;return _.assign(e,i),e}(t);return o.list(e,!0)}function f(t,e){n.operations&&!e||(n.operations=[]),t.forEach(function(t){n.operations.push(t),u[t.id]=u[t.id]||_.cloneDeep(p)}),n.paging=t.paging}function d(t){return 403===t.status?s.info(l("You need these roles to access bulk operations: Bulk operation Read/Admin")):s.danger(a.getString(t.data.message),t.data),e.reject()}function m(){var t=i.open;t&&(u[t]=_.assign(u[t]||_.cloneDeep(p),{showDetails:!0}))}function v(){n.paging.refresh().then(_.partialRight(f,!0))}n.operationDisplayOptions=u,n.realtime=g,n.refresh=v,n.loadNext=function(t){n.paging.loading=!0,t?h({pageSize:t}).then(f):n.paging.next().then(f).finally(function(){n.paging.loading=!1})},n.$on("$destroy",function(){g.stop()}),h().then(f,d).then(m).then(angular.bind(g,g.start))}t.$inject=["$scope","$routeParams","$interval","$q","c8yDeviceBulkControl","c8yRealtime","c8yAlert","gettextCatalog","gettext"],angular.module("c8y.deviceBulkControl").controller("bulkOperationsListCtrl",t)}();