"use strict";!function(){function e(t,e,n,i,c,l){var o,r=this,s={},d={},a=null,u={open:!1},f={text:""};function h(e){s={},d={},_.forEach(e,function(e){s[e.id]=!0,d[e.id]=!0})}function g(e){return d[e.id]}function p(e){d[e.id]=!0}function A(){return e("filter")(o,f.text)}function S(e){d[e.id]=!1}r.isSelected=g,r.selectAllVisible=function(){_.forEach(A(),p)},r.select=p,r.deselectAllVisible=function(){_.forEach(A(),S)},r.deselect=S,r.toggle=function(e){d[e.id]=!d[e.id]},r.areAllVisibleSelected=function(){var e=A();return!!e&&_.filter(e,g).length===e.length},r.getSelectedStatusText=function(){var e=_.filter(s,_.identity).length;return e===a?l.getString("All children active"):0===e?l.getString("No children active"):l.getPlural(e,"1 child active","{{$count}} children active",{})},r.apply=function(){t.onSelectionConfirmed&&t.onSelectionConfirmed({selection:_.filter(o,g)}),u.open=!1},r.filterCfg=f,r.dropdownStatus=u,t.$watch("parentMo()",function(e){r.parentMoId=e.id||e,c.detailCached(r.parentMoId).then(i.getResData).then(function(e){r.childAssets=_.map(e.childAssets.references,"managedObject"),o=r.childAssets,a=e.childAssets.references.length})}),t.$watch("selectedChildAssets()",h),t.$watch("ctrl.dropdownStatus.open",function(e){e&&h(t.selectedChildAssets()),n(function(){r.dropdownOpeningFinished=e})})}e.$inject=["$scope","$filter","$timeout","c8yBase","c8yInventory","gettextCatalog"],angular.module("c8y.smartRules").controller("c8yChildAssetsSelectorCtrl",e)}();