"use strict";!function(){function e(e,t,s,a,n,p){var l=this;function m(){return e.smartRestTemplateId}function r(){var e=m();return e?a.detail(e).then(function(e){l.template=e,l.requestTemplates=e[a.fragmentType].requestTemplates,l.responseTemplates=e[a.fragmentType].responseTemplates}):null}function u(e){l.selectedResponseTemplate=e}function c(){l.selectedResponseTemplate=void 0}function o(e){l.selectedRequestTemplate=e}function T(){l.selectedRequestTemplate=void 0}l.$onInit=function(){if(m())r();else var e=t.$on("$routeChangeSuccess",function(){m()&&(r(),e())})},l.changeTemplateName=function(e){return l.template.name=e,a.save(_.pick(l.template,["id","name"]))},l.countRequestTemplates=function(){return l.template&&a.countRequestTemplates(l.template)},l.selectResponseTemplate=u,l.deselectResponseTemplate=c,l.newResponseTemplate=function(){u(a.newResponseTemplate())},l.addResponseTemplate=function(e){var t=_.indexOf(l.template[a.fragmentType].responseTemplates,l.selectedResponseTemplate);-1===t?a.addResponseTemplate(l.template,e):l.template[a.fragmentType].responseTemplates[t]=e;return a.save(_.pick(l.template,["id",a.fragmentType])).then(c).then(_.partial(n.success,p("Response template saved.")))},l.removeResponseTemplate=function(){return a.removeResponseTemplate(l.template,l.selectedResponseTemplate),a.save(_.pick(l.template,["id",a.fragmentType])).then(c).then(_.partial(n.success,p("Response template deleted.")))},l.countResponseTemplates=function(){return l.template&&a.countResponseTemplates(l.template)},l.selectRequestTemplate=o,l.deselectRequestTemplate=T,l.newRequestTemplate=function(){o(a.newRequestTemplate())},l.addRequestTemplate=function(e){var t=_.indexOf(l.template[a.fragmentType].requestTemplates,l.selectedRequestTemplate);-1===t?a.addRequestTemplate(l.template,e):l.template[a.fragmentType].requestTemplates[t]=e;return a.save(_.pick(l.template,["id",a.fragmentType])).then(T).then(_.partial(n.success,p("Message template saved.")))},l.removeRequestTemplate=function(){return a.removeRequestTemplate(l.template,l.selectedRequestTemplate),a.save(_.pick(l.template,["id",a.fragmentType])).then(T).then(_.partial(n.success,p("Message template deleted.")))}}e.$inject=["$routeParams","$scope","c8yBase","c8ySmartRestTemplates","c8yAlert","gettext"],angular.module("c8y.smartRestEditor").controller("SmartRestTemplateDetailsCtrl",e)}();