"use strict";!function(){function t(a,i,t,e,s,n,r,o,c,d,l,u){var g,m,h,P,f=t.tenantId,w=d("May contain lowercase letters, digits, and hyphens. Must start with a letter; hyphens only allowed in the middle; minimum 2 characters. ");function v(t){var e=t||{};a.storageLimitation.storageLimitPerDeviceEnabled=function(t){return a.storageLimitation.storageLimitFeatureEnabled&&!!t.storageLimitPerDevice}(e),e.storageLimitPerDevice=(e.storageLimitPerDevice||0)/1024/1024,a.tenant=e}function p(t){a.saveInProgress=t}function y(t){var e=!1;try{e=JSON.parse(t.value)}finally{(a.passwordStrengthEnforced=e)&&a.$watch("passwordStrengthUser.passwordStrength",function(t){t&&a.tenant.adminPass&&a.tenantForm.adminPass.$setValidity("password-strength","GREEN"===a.passwordStrengthUser.passwordStrength)})}}function E(t){a.tenantPolicies=_.union([{name:l.getString("None")}],t)}_.assign(a,{validation:u.validation,tenantIdDomainHelpText:w,maxStorageLimitPerDevice:(m=Number.MAX_SAFE_INTEGER||9007199254740991,Math.round(m/1024/1024)),passwordStrengthUser:{},cancel:function(){i.path("tenants")},save:function(t,n){a.isNew&&a.host&&(t.domain=t.id+a.host);var e=_.cloneDeep(t);a.storageLimitation.storageLimitPerDeviceEnabled?e.storageLimitPerDevice=1024*e.storageLimitPerDevice*1024:e.storageLimitPerDevice=0;p(!0),s.save(e).then(function(t){var e=t.data;return function(t,e){a.isNew&&i.path("/tenants/".concat(t.id));_.assign(a.tenant,t),o.success(d("Tenant saved.")),e.$setPristine()}(e,n)}).finally(function(){p(!1)})},shouldShowSubtenantCheckbox:function(){var t=a.tenant&&s.isParentTopTenant(a.tenant);return g&&(t||a.isNew)},storageLimitation:{storageLimitPerDeviceEnabled:!1,storageLimitFeatureEnabled:n.appOption("storageLimitationFeatureEnabled")},humanize:n.humanizeFragment,saveInProgress:!1,changePasswordConfirm:function(){var t=a.tenantForm.confirmPassword,e=t.$modelValue,n=a.tenant.adminPass;t.$setValidity("password-mismatch",e===n)},changePassword:!1,resetPassword:function(){a.changePassword=!a.changePassword,a.changePassword||(a.tenant.adminPass=null)}}),s.current().then(function(t){var e=t.domainName;return".".concat(e.split(".").slice(1).join("."))}).then(function(t){a.host=t}),s.isCurrentUserTopTenant().then(function(t){g=t}),f&&"new"!==f?s.detail(f).then(function(t){return t.data}).then(v):(v({sendPasswordResetEmail:a.isNew=!0}),r.changeTitle({title:d("New tenant")}),P=!(h="c8yTenantPolicies"),e.has(h)&&(P=!0,e.get(h).list().then(E)),a.selectTenantPolicy=P),c.checkIfStrongPasswordRequired().then(y),s.isEnterpriseEditionTenant().then(function(t){a.isEnterpriseEditionTenant=t})}t.$inject=["$scope","$location","$routeParams","$injector","c8yTenant","c8yBase","c8yTitle","c8yAlert","c8yTenantOptions","gettext","gettextCatalog","c8yConfig"],angular.module("c8y.tenants").controller("tenantDetailCtrl",t)}();