"use strict";!function(){function s(e,n,o,r){var i,t=this,s={source:null,type:"*",scope:"MANAGED_OBJECT",access:null},a=["ROLE_USER_MANAGEMENT_ADMIN","ROLE_INVENTORY_ADMIN"];function c(s){t.permissions=s}function u(){var s=_.last(_.get(t,"permissions.groups"));return!s||s.group&&s.access}_.assign(t,{$onChanges:function(s){t.dashboard&&o.getFlag("deprecated")&&n.mustHaveAllRoles(a).then(function(){e.show(),i=!0,function(s){n.getMOPermissions(s).then(c)}(t.dashboard),r.list().then(function(s){t.groups=function(s){var e=["id","name"];return _.map(s,function(n){return _.reduce(e,function(s,e){return s[e]=n[e],s},{})})}(s)})});s.saved&&t.saved&&i&&n.setMOPermissions(t.dashboard,t.permissions)},clearPermissions:function(){t.dashboard.global&&(t.permissions.groups=[])},removePermission:function(e){_.remove(_.get(t,"permissions.groups"),function(s){return s===e})},addPermission:function(){if(!u())return;t.permissions.groups.push(_.cloneDeep(s))},canAddPermission:u,accessTypes:n.getAccessTypes()}),e.hide()}s.$inject=["$element","c8yPermissions","c8yBase","c8yUserGroup"],angular.module("c8y.parts.dashboard2").component("c8yDashboardPermissions",{templateUrl:":::PLUGIN_PATH:::/dashboard/dashboardPermissions.html",controllerAs:"vm",controller:s,bindings:{dashboard:"<",saved:"<"}})}();